require 'vimrunner'

vim = Vimrunner.start
vim.add_plugin(File.expand_path('../..', __FILE__), 'plugin/CompileLaTex.vim')

RSpec.describe "CompileLaTex.vim" do
    after(:all) do
        vim.kill
    end
RSpec.describe "run plugin" do
      specify "compile LaTex" do
          LaTexFile
          vim.edit 'test.tex'                                                             
          $vim.normal 'F10'
          File.exist?(text.pdf).should eq true
      end
  end
  
  def LaTExFile
          File.open("test.tex", "w") do |f|
              f.puts(<<-EOF)
                  \documentclass[12pt]{article}
                  %   options include 12pt or 11pt or 10pt
                  %   classes include article, report, book, letter, thesis
                  \title{This is the title}
                  \author{Author One \\ Author Two}
                  \date{29 February 2004}
                  
                  \begin{document}
                  \maketitle
                  
                  This is the content of this document.
                  
                  This is the 2nd paragraph.
                  Here is an inline formula:
                  $   V = \frac{4 \pi r^3}{3}  $.
                  And appearing immediately below
                  is a displayed formula:
                  $$  V = \frac{4 \pi r^3}{3}  $$
                  \end{document}
              EOF
  end

